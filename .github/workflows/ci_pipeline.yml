name: CI Pipeline

on:
  pull_request:
    branches:
      - develop
      - release

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # ğŸ”¥ google-services.json íŒŒì¼
      - name: Restore google-services.json
        env:
          DATA_ANDROID: ${{ secrets.GOOGLE_SERVICES_JSON }}
        run: echo "$DATA_ANDROID" > android/app/google-services.json

      # ğŸ”¥ .env.dev íŒŒì¼ ìƒì„±
      - name: Create .env.dev file
        run: echo "${{ secrets.ENV_DEV }}" > .env.dev

      # ğŸ”¥ Flutter SDK ì„¤ì¹˜ ë° ìºì‹œ í™œì„±í™”
      - name: Install Flutter SDK
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.27.0'
          cache: true

      # ğŸ”¥ Flutter ì˜ì¡´ì„± ì„¤ì¹˜
      - name: Install Flutter dependencies
        run: flutter pub get

      # ğŸ”¥ ë¦°íŠ¸ ì²´í¬
      - name: Flutter lint check
        run: flutter analyze

      # ğŸ”¥ Android ë¹Œë“œ
      - name: Build Android Debug APK
        run: flutter build apk --debug

#  # iOS ë¹Œë“œ(macOS í™˜ê²½)
#  ios_build:
#    runs-on: macos-latest
#
#    steps:
#      - name: Checkout
#        uses: actions/checkout@v4
#
#      # Flutter SDK ìºì‹œ ì„¤ì •
#      - name: Cache Flutter SDK
#        uses: actions/cache@v2
#        with:
#          path: ~/.pub-cache
#          key: ${{ runner.os }}-flutter-${{ hashFiles('**/pubspec.yaml') }}
#          restore-keys: |
#            ${{ runner.os }}-flutter-
#
#      # Flutter ì˜ì¡´ì„± ì„¤ì¹˜
#      - name: Install Flutter dependencies
#        run: flutter pub get
#
#      # ë¦°íŠ¸ ì²´í¬
#      - name: Flutter lint check
#        run: flutter analyze
#
#      # iOS ë¹Œë“œ
#      - name: Build iOS
#        run: flutter build ios --release --no-codesign